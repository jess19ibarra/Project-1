<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
     
    <!-- CSS STyle Sheet -->
     <link rel="stylesheet" href="assets/style.css">
</head>

<body>

        <div class="userIcon"><img src="assets/images/user-circle-solid.svg" alt="user-icon"></div> 

        <!--static nav bar-->

        <div class="container">
                <header>
                  <a href="#"><img class="hpLogo" src="assets/images/nom_nom_logo.png" alt="nomNomLogo" width="87" height="76" id="Insert_logo"/></a>
                </header>
                <div class="btn-group btn-group-toggle" data-toggle="buttons">
                    <label class="btn btn-secondary active">
                      <input type="radio" name="options" id="option1" autocomplete="off" checked> Ingredients Search
                    </label>
                    <label class="btn btn-secondary">
                      <input type="radio" name="options" id="option2" autocomplete="off"> Browse Recipes
                    </label>
                    <label class="btn btn-secondary">
                      <input type="radio" name="options" id="option3" autocomplete="off"> Trending Recipes
                    </label>
                    
                  </div>
            </div>
        </div>
        <br>
        <div class="container ingredientSearch">
            <input type="text" class="form-control" id="general-search">
            <button type="button" class="btn btn-dark btn-add">Add</button>
        </div>

        <br>

        <div class="row">
                <div class="col-sm-6">
                  <div class="card cardOne">
                    <div class="card-body">
                      <ul class="card-text" id=""></ul>
                      <!-- <a href="#" class="btn btn-primary">Go somewhere</a> -->
                    </div>
                  </div>
                </div>
                <div class="col-sm-6">
                  <div class="card cardTwo">
                    <div class="card-body">
                            <ul class="card-text" id="search-results"></ul>
                      <!-- <a href="#" class="btn btn-primary">Go somewhere</a> -->
                    </div>
                  </div>
                </div>
              </div>


    <ul id="search-results">
        <!-- <li>
            <h3>Title</h3>
            <p>text</p>
        </li> -->
    </ul>

    <div id="current-recipe">
        <div id="recipe-details"></div>

        <div id="instructions"></div>
    </div>


    


    <footer>
            <p>Brought to you by SMU Coding Bootcamp Group</p>
        </footer>

    <script src="https://code.jquery.com/jquery-3.4.1.min.js"
        integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
    <script>

        //////////////////////////////////// Jarrells Code //////////////////////////////////
        var API_KEY = '4d398387f70a4f9998f7774f5ff18d19';

        //Event Handler to run when user types in input
        $(".btn-add").on("click", function (e) {
            //Prevents default functionality to stop page reload
            e.preventDefault();

            //Empties the html results
            $("#recipe-details, #instructions, #search-results").empty();

            //Gets the value of what the user typed in search bar
            var query = $("#general-search").val();

            //The api call url
            var url = "https://api.spoonacular.com/recipes/search?query=" + query + "&apiKey=" + API_KEY;

            $.ajax({
                url,
                method: "GET"
            }).then(function (response) {
                console.log(response);
                // $("#search-results").empty();

                //Loops through search results and adds the list of recipes that pops up
                response.results.forEach(function (result) {
                    $("#search-results").append("<li class='main-result' data-recipe-id='" + result.id + "'>" +
                        "<h3>" + result.title + "</h3>" +
                        "<p>Ready in " + result.readyInMinutes + " minutes</p>" +
                        "<p>" + result.servings + " servings</p>"
                        + "<img style='max-width: 400px;' src='https://spoonacular.com/recipeImages/" + result.image + "'>" +
                        "</li>");
                });
            });

        });


        //Event Handler for when user clicks result item
        $("#search-results").on("click", ".main-result", function () {

            //Empties the html results
            $("#recipe-details, #instructions, #search-results").empty();

            //Gets id of recipe
            var id = $(this).data("recipe-id");

            //The api call url
            var url = "https://api.spoonacular.com/recipes/" + id + "/information?apiKey=" + API_KEY;

            $.ajax({
                url,
                method: "GET"
            }).then(function (response) {

                console.log(response);
                //Displays recipe details
                $("#recipe-details").html("<h3>" + response.title + "</h3>" +
                    "<p>Likes: " + response.aggregateLikes + "</p>" +
                    "<p>Health Score: " + response.healthScore + "</p>" +
                    "<p>Ready in " + response.readyInMinutes + " minutes</p>" +
                    "<p>Price per serving: " + response.pricePerServing + "</p>" +
                    "<p>Servings: " + response.servings + "</p>");
            });

            //api call for recipe instructions 
            var instructionsUrl = "https://api.spoonacular.com/recipes/" + id + "/analyzedInstructions?apiKey=" + API_KEY;

            $.ajax({
                url: instructionsUrl,
                method: "GET"
            }).then(function (steps) {


                console.log(steps);
                //loops the instructions array and adds it to the instructions html
                steps[0].steps.forEach(function (step) {
                    $("#instructions").append("<p><strong>" + step.number + "</strong>: " + step.step + " </p>");
                });
            });
        });
        ////////////////////////////// END OF JARRELLS CODE ///////////////////////////////////

        ////////////////////////////// START OF JESSICA I CODE ///////////////////////////////


        $.ajax({
            url: "https://api.spoonacular.com/recipes/findByIngredients?ingredients=apples,+flour,+sugar&number=2&apiKey=" + API_KEY,
            method: "GET"
        }).then(function (ingredients) {
            console.log(ingredients);
        });

        $.ajax({
            url: "https://api.spoonacular.com/recipes/random?apiKey=" + API_KEY,
            method: "GET"
        }).then(function (popular) {
            console.log(popular);
        });

    </script>

</body>

</html>